# Phase 7: Quadratic Functions & Visual Regression

## Overview

**Goal**: Build the QuadraticExplorer widget with a reusable coordinate system foundation, and establish visual regression testing infrastructure.

**Philosophy Alignment**: Quadratic functions are foundational algebra with direct programming applications (physics simulations, optimization algorithms, game development). The coordinate system built here will be reused for exponentials, trigonometry, and calculus visualizations.

---

## Decisions (Confirmed)

| ID | Decision | Rationale |
|----|----------|-----------|
| D-059 | Visual regression before new visuals | Capture baselines before adding complexity |
| D-060 | Coordinate system supports negative domain/range | Required for `a < 0` parabolas |
| D-061 | Static form display (no animation) | MVP simplicity; animation deferred |
| D-062 | "No real roots" with link for Δ < 0 | Avoid complex arithmetic on quadratics page |
| D-063 | 8 presets (5 basic + 3 real-world) | Real-world scenarios reinforce practical math |

---

## Increment 7A: Visual Regression Testing Infrastructure

**Effort**: 3-4 hours

### Objectives
1. Configure Playwright for screenshot comparison
2. Capture baseline screenshots for all existing pages
3. Integrate visual tests into CI workflow

### Tasks

#### 1. Playwright Visual Configuration
Update `playwright.config.ts`:
- Enable `expect.toHaveScreenshot()` with appropriate threshold
- Configure snapshot directory (`e2e/__screenshots__`)
- Set consistent viewport for visual tests (1280x720 desktop, 375x667 mobile)

#### 2. Visual Test File Structure
```
e2e/
├── visual/
│   └── snapshots.spec.ts    # All visual regression tests
└── __screenshots__/         # Generated by Playwright
    ├── snapshots.spec.ts-chromium/
    └── snapshots.spec.ts-firefox/
```

#### 3. Baseline Pages to Capture
| Page | Route | Notes |
|------|-------|-------|
| Home | `/` | Hero section |
| Basics Index | `/basics` | Topic cards |
| Foundations | `/basics/foundations` | Content page |
| Math Symbols | `/basics/symbols` | Symbol tables |
| Number Types | `/basics/number-types` | With NumberTypeExplorer |
| Functions | `/basics/functions` | With SimpleFunctionDemo |
| Variables | `/basics/variables` | Content only |
| Order of Operations | `/basics/order-of-operations` | Content only |
| Algebra Index | `/algebra` | Topic cards |
| Summation | `/algebra/summation` | With SummationExplorer |

#### 4. Visual Test Pattern
```typescript
// Pattern for each page
test('page-name visual regression', async ({ page }) => {
  await page.goto('/route')
  await page.waitForLoadState('networkidle')
  // Wait for any lazy-loaded content (KaTeX, Shiki)
  await page.waitForTimeout(500)
  await expect(page).toHaveScreenshot('page-name.png', {
    fullPage: true,
    threshold: 0.1, // Allow 10% pixel difference
  })
})
```

#### 5. Widget State Snapshots
For interactive widgets, capture key states:
- NumberTypeExplorer: default, with "42" entered, with "3.14" entered
- SummationExplorer: default preset, custom bounds, animation paused mid-way

#### 6. CI Workflow Update
Add visual regression job to `.github/workflows/ci.yml`:
- Runs after E2E tests pass
- Uploads screenshot artifacts on failure
- Consider: separate workflow for visual tests (slower, run on PR only)

#### 7. Documentation
Create `docs/VISUAL_TESTING.md`:
- How to update baselines: `npx playwright test --update-snapshots`
- How to review failures
- When to update vs. investigate

### Success Criteria
- [ ] `npm run test:visual` command works
- [ ] All existing pages have baseline screenshots
- [ ] CI fails when visual regression detected
- [ ] Documentation explains workflow

### Constraints
- Use Chromium only for baselines (cross-browser visual testing is flaky)
- Disable animations during visual tests (`prefers-reduced-motion`)
- Mask dynamic content (timestamps, if any)

---

## Increment 7B: Coordinate System Foundation

**Effort**: 4-5 hours

### Objectives
1. Create reusable SVG coordinate system component
2. Support dynamic scaling and viewport
3. Provide API for plotting points and curves

### Component: CoordinateSystem.vue

#### Props Interface
```typescript
interface CoordinateSystemProps {
  // Bounds
  xMin: number          // e.g., -10
  xMax: number          // e.g., 10
  yMin: number          // e.g., -10
  yMax: number          // e.g., 10
  
  // Appearance
  width?: number        // SVG width, default 400
  height?: number       // SVG height, default 400
  showGrid?: boolean    // Show grid lines, default true
  gridStep?: number     // Grid line spacing, default 1
  showAxisLabels?: boolean  // Show numeric labels, default true
  
  // Accessibility
  ariaLabel?: string    // Description for screen readers
}
```

#### Slots
```vue
<!-- Default slot for plotted content -->
<CoordinateSystem :x-min="-5" :x-max="5" :y-min="-5" :y-max="5">
  <!-- Child content receives coordinate transform functions -->
  <template #default="{ toSvgX, toSvgY, toDataX, toDataY }">
    <!-- Plot points, curves, etc. -->
  </template>
</CoordinateSystem>
```

#### Exposed Functions (via slot props)
```typescript
// Convert data coordinates to SVG coordinates
toSvgX(dataX: number): number
toSvgY(dataY: number): number

// Convert SVG coordinates to data coordinates (for mouse interaction)
toDataX(svgX: number): number
toDataY(svgY: number): number
```

#### Visual Elements
1. **Axes**: X and Y axes through origin (or edge if origin not in view)
2. **Grid**: Light gray grid lines at `gridStep` intervals
3. **Labels**: Numeric labels on axes (skip 0 to avoid overlap)
4. **Arrow heads**: Optional arrow heads on axis ends
5. **Origin marker**: Small circle at (0, 0) if in view

#### Styling
- Use CSS custom properties for theming (works with dark mode)
- Grid: `stroke: var(--color-border)`
- Axes: `stroke: var(--color-text-secondary)`
- Labels: `fill: var(--color-text-muted)`, `font-size: 10px`

#### Responsive Behavior
- Component fills container width by default
- Maintains aspect ratio based on x/y ranges
- `viewBox` attribute for scalable SVG

### Helper Components

#### PlotCurve.vue
```typescript
interface PlotCurveProps {
  // Function to plot
  fn: (x: number) => number
  
  // Sampling
  xMin: number
  xMax: number
  samples?: number      // Points to sample, default 100
  
  // Style
  strokeColor?: string  // default 'var(--color-primary)'
  strokeWidth?: number  // default 2
  
  // Coordinate transform (provided by parent)
  toSvgX: (x: number) => number
  toSvgY: (y: number) => number
}
```

Generates SVG `<path>` element from function samples.

#### PlotPoint.vue
```typescript
interface PlotPointProps {
  x: number
  y: number
  label?: string
  color?: string
  size?: number         // radius, default 5
  toSvgX: (x: number) => number
  toSvgY: (y: number) => number
}
```

Renders a point with optional label.

#### PlotLine.vue
```typescript
interface PlotLineProps {
  // Vertical or horizontal line
  type: 'vertical' | 'horizontal'
  value: number         // x for vertical, y for horizontal
  strokeColor?: string
  strokeWidth?: number
  dashed?: boolean
  label?: string
  toSvgX: (x: number) => number
  toSvgY: (y: number) => number
}
```

For axis of symmetry, asymptotes, etc.

### File Structure
```
src/components/visualizations/
├── CoordinateSystem.vue
├── PlotCurve.vue
├── PlotPoint.vue
├── PlotLine.vue
└── index.ts            # Barrel export
```

### Unit Tests
- Coordinate transformation accuracy
- Edge cases: origin at edge, negative-only ranges
- Prop validation

### Success Criteria
- [ ] CoordinateSystem renders axes and grid correctly
- [ ] Coordinate transformations are mathematically accurate
- [ ] Dark mode colors work
- [ ] Responsive to container width
- [ ] PlotCurve renders smooth curves
- [ ] PlotPoint renders with labels
- [ ] Accessible (aria-label, role="img")

### Constraints
- SVG only (no Canvas) for consistency with existing visualizations
- Must handle edge cases: very large ranges, very small ranges
- No external dependencies (D3, Chart.js)

---

## Increment 7C: Quadratic Math Utilities

**Effort**: 2-3 hours

### Objectives
1. Extract quadratic math functions from archive
2. Create TypeScript types for quadratic operations
3. Full unit test coverage

### File: `src/utils/math/quadratic.ts`

#### Types
```typescript
export interface QuadraticCoefficients {
  a: number  // x² coefficient (must be non-zero)
  b: number  // x coefficient
  c: number  // constant term
}

export interface Vertex {
  x: number
  y: number
}

export interface DiscriminantResult {
  value: number
  rootType: 'two-real' | 'one-real' | 'two-complex'
}

export interface QuadraticRoots {
  type: 'two-real' | 'one-real' | 'two-complex'
  roots: number[]  // Empty for complex, 1 for repeated, 2 for distinct
  // For complex roots, we don't compute them here
}

export interface VertexForm {
  a: number  // Same as standard form
  h: number  // x-coordinate of vertex
  k: number  // y-coordinate of vertex
}

export interface FactoredForm {
  a: number
  r1: number
  r2: number
} | null  // null if roots are complex
```

#### Functions
```typescript
/**
 * Calculate the vertex of a parabola
 * Vertex x = -b/(2a), y = f(x)
 */
export function calculateVertex(coeffs: QuadraticCoefficients): Vertex

/**
 * Calculate discriminant and classify root type
 * Δ = b² - 4ac
 */
export function calculateDiscriminant(coeffs: QuadraticCoefficients): DiscriminantResult

/**
 * Find real roots using quadratic formula
 * Returns empty array for complex roots
 */
export function solveQuadratic(coeffs: QuadraticCoefficients): QuadraticRoots

/**
 * Convert standard form to vertex form
 * y = a(x - h)² + k
 */
export function toVertexForm(coeffs: QuadraticCoefficients): VertexForm

/**
 * Convert standard form to factored form (if real roots exist)
 * y = a(x - r1)(x - r2)
 */
export function toFactoredForm(coeffs: QuadraticCoefficients): FactoredForm | null

/**
 * Evaluate f(x) = ax² + bx + c
 */
export function evaluateQuadratic(coeffs: QuadraticCoefficients, x: number): number

/**
 * Generate points for plotting
 */
export function generateQuadraticPoints(
  coeffs: QuadraticCoefficients,
  xMin: number,
  xMax: number,
  samples?: number
): Array<{ x: number; y: number }>
```

### Test Cases

#### calculateVertex
- Standard parabola: a=1, b=0, c=0 → vertex at (0, 0)
- Shifted: a=1, b=-4, c=3 → vertex at (2, -1)
- Inverted: a=-1, b=0, c=4 → vertex at (0, 4)

#### calculateDiscriminant
- Two real roots: Δ > 0 (e.g., a=1, b=0, c=-1)
- One real root: Δ = 0 (e.g., a=1, b=-2, c=1)
- Complex roots: Δ < 0 (e.g., a=1, b=0, c=1)

#### solveQuadratic
- x² - 1 = 0 → roots [1, -1]
- x² - 2x + 1 = 0 → roots [1]
- x² + 1 = 0 → roots [] (complex)

#### toVertexForm
- a=1, b=0, c=0 → {a: 1, h: 0, k: 0}
- a=1, b=-4, c=3 → {a: 1, h: 2, k: -1}

#### toFactoredForm
- x² - 1 → {a: 1, r1: 1, r2: -1}
- x² + 1 → null (complex roots)

### Success Criteria
- [ ] All functions implemented with correct math
- [ ] Edge cases handled (a=0 throws, floating point precision)
- [ ] 100% test coverage
- [ ] JSDoc comments on all exports

### Constraints
- Pure functions only (no side effects)
- Handle floating-point precision gracefully
- Throw meaningful errors for invalid input (a=0)

---

## Increment 7D: QuadraticExplorer Widget

**Effort**: 6-8 hours

### Objectives
1. Build interactive coefficient controls
2. Render parabola using CoordinateSystem
3. Display equation forms and analysis
4. Implement presets and URL state

### Component Structure
```
src/components/widgets/QuadraticExplorer/
├── QuadraticExplorer.vue       # Main widget
├── CoefficientControls.vue     # Slider inputs for a, b, c
├── EquationDisplay.vue         # Shows all three forms
├── AnalysisPanel.vue           # Discriminant, roots, vertex info
├── PresetSelector.vue          # Dropdown/buttons for presets
├── types.ts                    # Local types
├── presets.ts                  # Preset definitions
└── useQuadraticExplorer.ts     # Composable for state management
```

### Main Component: QuadraticExplorer.vue

#### Layout (Desktop)
```
┌─────────────────────────────────────────────────────────┐
│ [Preset Dropdown ▾]                                      │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌─────────────────────┐  ┌──────────────────────────┐ │
│  │                     │  │ Standard: y = ax² + bx + c│ │
│  │                     │  │ Vertex:   y = a(x-h)² + k │ │
│  │   [Coordinate       │  │ Factored: y = a(x-r₁)(x-r₂)│ │
│  │    System with      │  ├──────────────────────────┤ │
│  │    Parabola]        │  │ Discriminant: Δ = ...    │ │
│  │                     │  │ Roots: x = ...           │ │
│  │                     │  │ Vertex: (h, k)           │ │
│  │                     │  │ Axis of Symmetry: x = h  │ │
│  └─────────────────────┘  └──────────────────────────┘ │
│                                                         │
├─────────────────────────────────────────────────────────┤
│  a: [====●========] -3 to 3, step 0.1                   │
│  b: [========●====] -10 to 10, step 0.5                 │
│  c: [====●========] -10 to 10, step 0.5                 │
└─────────────────────────────────────────────────────────┘
```

#### Layout (Mobile)
Stack vertically: Presets → Graph → Controls → Analysis

#### State Management
```typescript
// useQuadraticExplorer.ts
export function useQuadraticExplorer() {
  const a = ref(1)
  const b = ref(0)
  const c = ref(0)
  
  // Derived values
  const coefficients = computed(() => ({ a: a.value, b: b.value, c: c.value }))
  const vertex = computed(() => calculateVertex(coefficients.value))
  const discriminant = computed(() => calculateDiscriminant(coefficients.value))
  const roots = computed(() => solveQuadratic(coefficients.value))
  const vertexForm = computed(() => toVertexForm(coefficients.value))
  const factoredForm = computed(() => toFactoredForm(coefficients.value))
  
  // Auto-scale coordinate system
  const bounds = computed(() => {
    const v = vertex.value
    const padding = 5
    return {
      xMin: Math.min(-10, v.x - padding),
      xMax: Math.max(10, v.x + padding),
      yMin: Math.min(-10, v.y - padding),
      yMax: Math.max(10, v.y + padding),
    }
  })
  
  return { a, b, c, coefficients, vertex, discriminant, roots, vertexForm, factoredForm, bounds }
}
```

### Presets (presets.ts)
```typescript
export interface QuadraticPreset {
  id: string
  name: string
  description: string
  coefficients: QuadraticCoefficients
  category: 'basic' | 'real-world'
}

export const quadraticPresets: QuadraticPreset[] = [
  // Basic
  { id: 'standard', name: 'Standard', description: 'y = x²', coefficients: { a: 1, b: 0, c: 0 }, category: 'basic' },
  { id: 'wide', name: 'Wide', description: 'Flatter curve', coefficients: { a: 0.5, b: 0, c: 0 }, category: 'basic' },
  { id: 'narrow', name: 'Narrow', description: 'Steeper curve', coefficients: { a: 2, b: 0, c: 0 }, category: 'basic' },
  { id: 'shifted', name: 'Shifted', description: 'Moved vertex', coefficients: { a: 1, b: -4, c: 3 }, category: 'basic' },
  { id: 'inverted', name: 'Inverted', description: 'Opens downward', coefficients: { a: -1, b: 0, c: 4 }, category: 'basic' },
  
  // Real-world
  { 
    id: 'projectile', 
    name: 'Projectile Motion', 
    description: 'Ball thrown upward', 
    coefficients: { a: -4.9, b: 20, c: 1.5 }, 
    category: 'real-world' 
  },
  { 
    id: 'profit', 
    name: 'Profit Optimization', 
    description: 'Revenue minus costs', 
    coefficients: { a: -0.1, b: 50, c: -200 }, 
    category: 'real-world' 
  },
  { 
    id: 'reflector', 
    name: 'Parabolic Reflector', 
    description: 'Satellite dish cross-section', 
    coefficients: { a: 0.25, b: 0, c: 0 }, 
    category: 'real-world' 
  },
]
```

### Visual Elements on Graph
1. **Parabola curve**: Primary color, stroke-width 2
2. **Vertex point**: Highlighted point with label "(h, k)"
3. **Root points**: When real, marked on x-axis
4. **Axis of symmetry**: Dashed vertical line at x = h
5. **Y-intercept**: Point at (0, c)

### URL State Sync
Follow pattern from NumberTypeExplorer and SummationExplorer:
```typescript
// URL params: ?a=1&b=-4&c=3 or ?preset=projectile
const route = useRoute()
const router = useRouter()

// Initialize from URL
onMounted(() => {
  if (route.query.preset) {
    loadPreset(route.query.preset as string)
  } else {
    a.value = parseFloat(route.query.a as string) || 1
    b.value = parseFloat(route.query.b as string) || 0
    c.value = parseFloat(route.query.c as string) || 0
  }
})

// Update URL on change (debounced)
watch([a, b, c], () => {
  router.replace({ query: { a: a.value, b: b.value, c: c.value } })
}, { debounce: 300 })
```

### Accessibility
- Sliders: proper labels, aria-valuemin/max/now
- Graph: aria-label describing the parabola
- Keyboard: Tab through controls, sliders adjustable with arrow keys
- Screen reader: Announce coefficient changes and resulting equation

### Data-testid Attributes
```
data-testid="coefficient-a-slider"
data-testid="coefficient-b-slider"
data-testid="coefficient-c-slider"
data-testid="preset-selector"
data-testid="preset-{id}"
data-testid="equation-standard"
data-testid="equation-vertex"
data-testid="equation-factored"
data-testid="discriminant-value"
data-testid="roots-display"
data-testid="vertex-display"
data-testid="quadratic-graph"
```

### E2E Tests
```typescript
// e2e/widgets/quadratic-explorer.spec.ts

test('default state shows standard parabola', async ({ page }) => {
  await page.goto('/algebra/quadratics')
  await expect(page.locator('[data-testid="equation-standard"]')).toContainText('y = x²')
})

test('adjusting coefficient a changes curve steepness', async ({ page }) => {
  // Change a from 1 to 2
  // Verify equation updates
})

test('preset loads correct coefficients', async ({ page }) => {
  await page.locator('[data-testid="preset-selector"]').click()
  await page.locator('[data-testid="preset-projectile"]').click()
  // Verify coefficients match preset
})

test('URL state syncs with coefficients', async ({ page }) => {
  await page.goto('/algebra/quadratics?a=2&b=-4&c=1')
  // Verify sliders reflect URL values
})

test('complex roots show message with link', async ({ page }) => {
  // Set a=1, b=0, c=1 (discriminant < 0)
  await expect(page.locator('[data-testid="roots-display"]')).toContainText('No real roots')
})
```

### Success Criteria
- [ ] All 8 presets work correctly
- [ ] Sliders update graph in real-time
- [ ] All three equation forms display with KaTeX
- [ ] Discriminant analysis is accurate
- [ ] Vertex, roots, axis of symmetry visible on graph
- [ ] URL state sync works
- [ ] Mobile layout is usable
- [ ] All E2E tests pass
- [ ] Accessible (keyboard, screen reader)

### Constraints
- Slider ranges: a ∈ [-3, 3] (exclude 0), b ∈ [-10, 10], c ∈ [-10, 10]
- Auto-scale coordinate system to keep vertex and roots visible
- When a=0, show error or disable (not a quadratic)

---

## Increment 7E: Quadratics Content

**Effort**: 4-5 hours

### Objectives
1. Create QuadraticsView with comprehensive content
2. Integrate QuadraticExplorer widget
3. Add code examples for Python implementations

### Route Setup
Add to `src/router/index.ts`:
```typescript
{
  path: '/algebra/quadratics',
  name: 'quadratics',
  component: () => import('@/views/algebra/QuadraticsView.vue'),
}
```

Add to `src/data/navigation.ts`:
```typescript
// Under algebra section
{
  title: 'Quadratic Functions',
  path: '/algebra/quadratics',
  description: 'Parabolas, roots, and the quadratic formula',
}
```

### Content Structure

#### Section 1: What is a Quadratic Function? (NOT collapsible)
- Definition: polynomial of degree 2
- Standard form: y = ax² + bx + c
- The parabola shape
- Key features: opens up (a > 0) or down (a < 0)
- Connection to programming: physics engines, game trajectories

#### Section 2: Interactive Explorer (NOT collapsible)
- Embed QuadraticExplorer widget
- Brief instructions on how to use

#### Section 3: Understanding the Coefficients (collapsible)
- **a**: Controls width and direction
  - |a| > 1: narrower
  - |a| < 1: wider
  - a < 0: opens downward
- **b**: Controls horizontal position (combined with a)
- **c**: Y-intercept (where graph crosses y-axis)

Code example:
```python
def quadratic(x, a=1, b=0, c=0):
    """Evaluate quadratic function at x."""
    return a * x**2 + b * x + c

# Example: f(x) = 2x² - 4x + 1
f = lambda x: quadratic(x, a=2, b=-4, c=1)
print(f(0))   # 1 (y-intercept)
print(f(1))   # -1
print(f(2))   # 1
```

#### Section 4: The Three Forms (collapsible)
- **Standard form**: y = ax² + bx + c
  - Easy to read coefficients
  - Y-intercept obvious (c)
- **Vertex form**: y = a(x - h)² + k
  - Vertex immediately visible (h, k)
  - Easy to graph transformations
- **Factored form**: y = a(x - r₁)(x - r₂)
  - Roots immediately visible
  - Only exists for real roots

Code example:
```python
def standard_to_vertex(a, b, c):
    """Convert standard form to vertex form."""
    h = -b / (2 * a)
    k = a * h**2 + b * h + c
    return a, h, k

# Example: y = x² - 4x + 3
a, h, k = standard_to_vertex(1, -4, 3)
print(f"Vertex form: y = {a}(x - {h})² + {k}")
# Output: Vertex form: y = 1(x - 2)² + -1
```

#### Section 5: Solving Quadratic Equations (collapsible)
- Setting y = 0 to find roots
- The quadratic formula: x = (-b ± √(b²-4ac)) / 2a
- The discriminant (Δ = b² - 4ac):
  - Δ > 0: two distinct real roots
  - Δ = 0: one repeated real root
  - Δ < 0: no real roots (complex roots exist)
- Connection to NumberTypeExplorer: complex numbers

Code example:
```python
import math

def solve_quadratic(a, b, c):
    """Find roots of ax² + bx + c = 0."""
    discriminant = b**2 - 4*a*c
    
    if discriminant > 0:
        x1 = (-b + math.sqrt(discriminant)) / (2*a)
        x2 = (-b - math.sqrt(discriminant)) / (2*a)
        return [x1, x2]
    elif discriminant == 0:
        x = -b / (2*a)
        return [x]
    else:
        # Complex roots - see Number Types!
        return []

# Example: x² - 5x + 6 = 0
roots = solve_quadratic(1, -5, 6)
print(f"Roots: {roots}")  # [3.0, 2.0]
```

#### Section 6: Real-World Applications (collapsible)
- **Projectile Motion**: h(t) = -½gt² + v₀t + h₀
- **Profit Optimization**: P(x) = -ax² + bx - c
- **Parabolic Reflectors**: Focus property

Code example:
```python
def projectile_height(t, v0=20, h0=1.5, g=9.8):
    """
    Calculate height of projectile at time t.
    v0: initial velocity (m/s)
    h0: initial height (m)
    g: gravity (m/s²)
    """
    return -0.5 * g * t**2 + v0 * t + h0

# Find when ball hits ground (h = 0)
# Using quadratic formula with a=-4.9, b=20, c=1.5
import math
a, b, c = -4.9, 20, 1.5
t = (-b - math.sqrt(b**2 - 4*a*c)) / (2*a)
print(f"Ball hits ground at t = {t:.2f} seconds")
```

#### Section 7: Key Formulas Reference (NOT collapsible)
Quick reference table:
| Property | Formula |
|----------|---------|
| Vertex x-coordinate | h = -b/(2a) |
| Vertex y-coordinate | k = f(h) = c - b²/(4a) |
| Axis of symmetry | x = -b/(2a) |
| Discriminant | Δ = b² - 4ac |
| Quadratic formula | x = (-b ± √Δ) / (2a) |
| Y-intercept | (0, c) |

### Success Criteria
- [ ] Page renders with all sections
- [ ] Widget integrated and functional
- [ ] Code examples syntax-highlighted
- [ ] KaTeX renders all formulas
- [ ] Collapsible sections work
- [ ] Breadcrumbs correct
- [ ] Mobile responsive
- [ ] Added to navigation

### Constraints
- Follow existing content page patterns (TopicPage, ContentSection)
- Use MathBlock for formulas, CodeExample for code
- Keep explanations programmer-focused

---

## Increment 7F: Real-World Presets & Polish

**Effort**: 2-3 hours

### Objectives
1. Add contextual descriptions to real-world presets
2. Link complex roots to NumberTypeExplorer
3. Update visual regression baselines
4. Final polish pass

### Tasks

#### 1. Real-World Preset Enhancement
When a real-world preset is selected, show contextual information:

**Projectile Motion**:
- "This models a ball thrown upward at 20 m/s from 1.5m height"
- Highlight: vertex = max height, positive root = landing time

**Profit Optimization**:
- "Revenue minus costs as a function of units sold"
- Highlight: vertex = maximum profit point, roots = break-even points

**Parabolic Reflector**:
- "Cross-section of a satellite dish"
- Highlight: focus point at (0, 1/(4a))

#### 2. Complex Roots Connection
When discriminant < 0:
```vue
<div class="text-text-muted">
  <p>No real roots exist (discriminant < 0).</p>
  <p>
    The roots are complex numbers. Learn more in 
    <RouterLink to="/basics/number-types" class="text-primary hover:underline">
      Number Types
    </RouterLink>.
  </p>
</div>
```

#### 3. Visual Regression Baseline Updates
```bash
# Capture new baselines including quadratics page
npx playwright test --update-snapshots
```

New snapshots to add:
- `/algebra/quadratics` - default state
- `/algebra/quadratics` - with projectile preset
- `/algebra/quadratics` - with complex roots (a=1, b=0, c=1)

#### 4. Polish Checklist
- [ ] Slider hover states
- [ ] Graph transitions (smooth coefficient changes)
- [ ] Mobile touch targets (44x44px minimum)
- [ ] Loading state for route transitions
- [ ] Error boundary for invalid URL params
- [ ] Console warnings cleaned up

#### 5. Documentation Updates
- Update `docs/ROADMAP.md` with Phase 7 completion
- Add decisions to `docs/decisions.md`
- Add lessons to `docs/ll_li.md`
- Update `docs/current_state.md`

### Success Criteria
- [ ] Real-world presets show contextual descriptions
- [ ] Complex roots link to Number Types page
- [ ] All visual regression tests pass with new baselines
- [ ] No console warnings in production build
- [ ] Documentation updated

---

## Phase 7 Complete Checklist

Before marking Phase 7 complete:

### Testing
- [ ] All unit tests pass (`npm run test`)
- [ ] All E2E tests pass (`npm run test:e2e`)
- [ ] Visual regression baselines updated
- [ ] Accessibility audit passes for new pages

### Quality
- [ ] TypeScript strict mode passes (`npm run type-check`)
- [ ] ESLint passes (`npm run lint`)
- [ ] Production build succeeds (`npm run build`)
- [ ] No console errors in browser

### Documentation
- [ ] `docs/decisions.md` updated with D-059 through D-063
- [ ] `docs/ll_li.md` updated with any lessons learned
- [ ] `docs/current_state.md` updated
- [ ] `docs/ROADMAP.md` Phase 7 marked complete

### Deployment
- [ ] Deployed to GitHub Pages
- [ ] Verified all pages work in production

---

## File Summary

### New Files
```
src/components/visualizations/
├── CoordinateSystem.vue
├── PlotCurve.vue
├── PlotPoint.vue
├── PlotLine.vue
└── index.ts

src/components/widgets/QuadraticExplorer/
├── QuadraticExplorer.vue
├── CoefficientControls.vue
├── EquationDisplay.vue
├── AnalysisPanel.vue
├── PresetSelector.vue
├── types.ts
├── presets.ts
└── useQuadraticExplorer.ts

src/utils/math/quadratic.ts
src/utils/math/quadratic.test.ts

src/views/algebra/QuadraticsView.vue

e2e/visual/snapshots.spec.ts
e2e/widgets/quadratic-explorer.spec.ts

docs/VISUAL_TESTING.md
```

### Modified Files
```
src/router/index.ts          # Add quadratics route
src/data/navigation.ts       # Add quadratics to nav
playwright.config.ts         # Visual regression config
.github/workflows/ci.yml     # Visual regression job
docs/decisions.md            # New decisions
docs/ll_li.md                # Lessons learned
docs/current_state.md        # Status update
docs/ROADMAP.md              # Phase 7 complete
```

---

## Estimated Total Effort

| Increment | Effort |
|-----------|--------|
| 7A: Visual Regression | 3-4 hours |
| 7B: Coordinate System | 4-5 hours |
| 7C: Quadratic Utilities | 2-3 hours |
| 7D: QuadraticExplorer | 6-8 hours |
| 7E: Content | 4-5 hours |
| 7F: Polish | 2-3 hours |
| **Total** | **21-28 hours** |
